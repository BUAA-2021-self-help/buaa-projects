## 计网2011-2015级试卷整理

## 2011级

### 1.1 PDU地址

[CSDN：计网PDU地址](https://blog.csdn.net/qq_42145681/article/details/103817022)

以太网交换机根据所收到PDU的目的IP地址进行转发决策

PDU(protocol data unit）协议数据单元

* 集线器

集线器是第一层设备，不能分析到数据包的MAC和IP地址。它会泛洪(flooding)收到的数据包。

因此，PDU地址就是**泛洪(flooding)地址**。

* 交换机

交换机实质上是一个多端口网桥，工作在数据链路层，数据链路层使用物理地址进行转发，而转发通常都是根据目的地址来决定出端口。

在转发过程中，使用的是目的地址来进行转发决策的，

因此，PDU地址就是**目的物理地址**。

* 路由器

路由器工作在网络层，是一种具有多个输入端口和输出端口的专用计算机，其任务是转发分组。也就是，路由器某个输入端口收到分组，按照分组去的目的(即目的网络)，将分组从某个合适的输出端口转发给下一跳路由器。

因此，PDU地址就是**目的IP地址**。

### 2.4 检错码

* 奇偶校验码
* 循环冗余码CRC
### 2.5 PDU名称

OSI参考模型中，对等层协议之间交换的信息单元统称为协议数据单元(PDU,Protocol Data Unit)。

>page 30

传输层及以下各层的PDU另外还有各自特定的名称：

* 传输层——数据段（Segment）
* 网络层——分组（数据报）（Packet）
* 数据链路层——数据帧（Frame）
* 物理层——比特（Bit）

（还有网关，路由器等相关）

### 3.1 OSI&TCP/IP模型

![图片](https://uploader.shimo.im/f/TXUC0iSil2XkwiYg.png!thumbnail?fileGuid=HV8XWQpddyPPdqXP)

* 错误点：

每个子网的最后一个主机号，要把网络号最后一位之后都置1，再-1，而不是只给最后一个字节都置1：

![图片](https://uploader.shimo.im/f/Su8W8z2Ync6iIz9V.png!thumbnail?fileGuid=HV8XWQpddyPPdqXP)

比如这里容易手滑写成169.10.32.254

### 3.3 CSMA/CD的工作原理

答：CSMA/CD工作原理及工作过程如下：

1. 站点发送数据帧前先侦听信道是否忙，如果信道空闲，就立即发送数据；如果信道忙(即发现有其他站在发送数据)，则坚持听下去；
2. 数据帧的发送开始后，发送数据帧的站点要边发送边监听，只要监听到发生冲突就立即停止发送操作；
3. 然后，发送“冲突加强信号”，确保有足够的冲突持续时间，以便让所有用户都知道现在已经发生了冲突。延迟一段时间后，再重新竞争信道。
4. 
### 3.4 RARP、ICMP、IGMP、SMTP、POP3、PPP协议

* RARP：逆地址解析协议。作用是使只知道自己硬件地址的主机能够通过RARP协议找出其IP地址。
* ICMP：网际控制报文协议。（使主机/路由器报告差错情况和提供异常情况的报告）为了更有效地转发IP数据报和提高交付成功的机会，在网际层使用了ICMP。
* IGMP：网际组管理协议。为了让路由器知道多播组的成员信息。
* SMTP：简单邮件传送协议。规定了两个相互通信的SMTP进程之间如何交换信息。（是一组用于由源地址到目的地址传送邮件的规则。）
* POP3:邮件读取协议，用于用户从POP3服务器读取邮件，简单、功能有限。
* PPP：点对点协议。用户计算机和ISP进行通信时所使用的数据链路层协议。（广域网）
* 
### 3.5 解释WWW、HTTP、HTML、超文本、超链接

* WWW：万维网WWW是一个大规模的、联机式的信息储藏所。能非常方便地从互联网上的一个站点访问另一个站点（通过链接）
* HTTP：超文本传送协议。定义了浏览器（即万维网客户进程）怎样向万维网服务器请求万维网文档，以及服务器怎样把文档传送给浏览器。
* HTML：超文本标记语言。制作万维网页面的标准语言。
* 超文本：用超链接的方法，将各种不同空间任45的文字信息组织在一起的网状文本。
* 超链接：一种允许我们同其他网页或站点之间进行连接的元素。
### 3.6 域名的解析过程

* 当客户端需要域名解析时，通过本地的DNS客户端构造一个DNS请求报文，以UDP数据报的方式发往本地域名服务器。
* 本地域名服务器收到请求后，查询本地缓存，假设没有该记录，则以DNS客户的身份向根域名服务器发出请求，通过递归或迭代的方法进行查询。由权限域名服务器将结果返给本地域名服务器。
* 本地域名服务器将结果缓存，同时返回给客户机。
### 4.1 划分子网

子网掩码：255.255.255.224

[网络数和主机数，ABC类，CIDR的求法好像不一样](https://blog.csdn.net/Dr_Neo/article/details/52192811)？

// FIXME

|网络地址|最小主机IP|最大主机IP|
|:----|:----|:----|
|202.191.100.32|202.191.100.33|202.191.100.62|
|202.191.100.64|202.191.100.65|202.191.100.94|
|202.191.100.96|202.191.100.97|202.191.100.126|
|202.191.100.128|202.191.100.129|202.191.100.158|

（考虑主机号不为全0或全1）

|目的网络|子网掩码|下一跳地址|接口|
|:----|:----|:----|:----|
|202.191.100.32|255.255.255.224|-|eth0|
|202.191.100.64|255.255.255.224|-|eth1|
|202.191.100.96|255.255.255.224|-|eth2|
|202.191.100.128|255.255.255.224|-|eth3|

子网为什么不能全0或全1（IP地址ppt的102页）：

![图片](https://uploader.shimo.im/f/0bA9icXf0NuYK6Wp.png!thumbnail?fileGuid=HV8XWQpddyPPdqXP)

### 4.2 计算数据传播速率

以太网帧（书page 96）除数据外，还有6+6+2+4=18字节的帧头

故计算实际数据传播速率时要(1518-18)

另外注意题目中说，乙一收到数据，甲就发下一帧，因此中间差了单程传播时延，而不是RTT，因此不能套课本的公式

## 2012级

### 1.5 最短帧长

[CSDN：](https://blog.csdn.net/u012503786/article/details/78615551)[以太网的最大和最小帧长是怎样计算的](https://blog.csdn.net/u012503786/article/details/78615551)

最短帧长/传输速率**正比于**网络最大传输距离/光速

### 3.1 计算确认号

主机A向服务器发了2个报文段，序号分别为70和100

* 第一个报文段有多少字节？70~99，30字节
* 第一个报文段的确认号？100
* 第二个报文段的确认号是180。第二个报文段有多少字节？100~179，80字节
* 第一个报文段丢了，第二个报文段收到，第二个报文段的确认号是多少？70

确认号n就是接收方下一个期望收到的报文序号，n-1和之前的都正确收到了

### 3.2 TCP连接建立&释放

* 建立：page 238
    * 原因：防止已过期的连接再次传到被连接的主机
    * 好处：可靠，同步连接双方的序列号和确认号，并交换TCP窗口大小信息
* 释放：page 240
    * 原因：TCP是全双工模式，接受FIN意味着不会有数据再发来，但还可以发数据
    * 在关闭前发出所需数据，逐步关闭

另外TCP协议规定，连接一旦建立，报文的ACK都是1（课本具体哪页忘了）

### 3.3 域名、域名服务器

* 域名系统的主要功能是什么？
    * 用来把便于人们使用的机器名字转换为IP地址。
* 域名系统中本地域名服务器，根域名服务器，权限域名服务器分别有什么作用。
    * 根域名服务器：最高层次的域名服务器。所有的根域名服务器达知道所有的顶级域名服务器的域名和IP地址。
    * 顶级域名服务器：负责管理在该顶级域名服务器注册的所有二级域名。
    * 权限域名服务器：负责一个区的所有域名服务。
    * 本地域名服务器：（也称默认域名服务器）。当一台主机发出DNS查询请求时，该请求报文就发送给本地域名服务器。（响应区域内的DNS查询请求。）

### 3.4 ARP协议

地址解析协议ARP：完成IP地址到硬件地址的映射。

* 每个主机都有一个ARP高速缓存，里面有本局域网上的各主机和路由器的IP地址到硬件地址的映射表，这些都是该主机目前知道的一些地址。
* 当主机A想要向本局域网上的某主机B发送IP数据报时，就先在其ARP高速缓存中查看有无主机B的IP地址。如有，就在ARP高速缓存中查出其对应的硬件地址，再把这个硬件地址写入MAC帧，然后通过局域网；把该MAC帧发往此硬件地址。如无，则主机A自动运行ARP，以广播的形式找出主机B的硬件地址。

## 2013级

### 1.11 尼奎斯特公式

![图片](https://uploader.shimo.im/f/V0PVwUfrm9Qu7QGS.png!thumbnail?fileGuid=HV8XWQpddyPPdqXP)

无噪音，用$C=2W\log_2{M}$

C表示传输率，单位b/s或bps

W表示带宽，单位Hz

M表示信号电平级数

该公式可用于估算已知带宽信道的最高速率

选项都是kbps，因此用比特率，而不是波特率baud

4*4共16个状态，因此2*3*log2(16)=24kbps

### 2.4 路由器

路由器工作在三层，要把物理层，数据链路层，传输层写全了

### 3.2 IP地址&MAC地址

答：从层次角度看，物理地址是数据链路层和物理层适用的地址，而IP地址是网络层和以上各层使用的地址，是一种逻辑地址。IP地址放在IP数据报的首部，硬件地址放在MAC帧的首部，数字链路层看不见数据报的IP地址。

社会存在的异构网络之间相互通信需要进行复杂的硬件地址转换，非用户或用户主机能够完成，统一的IP地址隐藏了异构网络的细节，使它们之间的通信就像连在同一个网络上，简单方便。

* IP地址用于网络层，为逻辑地址
* MAC地址用于数据链路层，为硬件地址。

IP地址是逻辑地址，而物理地址是硬件地址。主机之间只能利用物理地址传送数据帧。当IP数据报必须经物理层，把它被封装到MAC帧里面后才能传到目的主机。

>page 127

由于全世界存在着各式各样的网络，它们使用不同的硬件地址。要使这些异构网络能够通信就必须进行非常复杂的硬件地址转换工作，因此由用户或用户主机来完成这项工作几乎是不可能的事。但IP编址把这个复杂问题解决了。连接到互联网的主机只需各自拥有一个唯一的IP地址。

### 3.3 RIP和OSPF功能和区别

答：主要功能：一个自治系统内部的动态路由选择协议，为路由器得到相应的路由表并选择信息的路由。

* RIP是分布式的基于距离向量的路由选择协议，仅和相邻路由器交换信息，交换的信息是当前本路由器所知道的全部信息，按固定的时间间隔交换信息。实现简单开销小，更新收敛慢，有跳数限制，使用于小网络。
* OSPF是适用分布式的链路状态协议，向自治系统中所有路由器发送消息，发送的信息是与本路由器相邻的所有路由器的链路状态，只有链路状态发生改变时才会发送信息。灵活控制，更新收敛快，实现复杂，适用于大网络。

**RIP协议**

>page 153

采用分布式的基于距离向量的路由选择协议

特点：

* 仅和相邻路由器交换信息
* 交换的信息是当前本路由器所知道的全部信息，即自己现在的路由表
* 按固定的时间间隔交换路由信息

示例：page 156

报文格式：page 157

使用用户数据报UDP进行传送

存在的问题：好消息传播得快，而坏消息传播得慢

**OSPF协议**

>page 159

开放最短路径优先OSPF

采用分布式的链路状态协议

特点：

* 向本自治系统中所有路由器发送信息
    * 采用洪泛法
* 发送的信息是与本路由器相邻的所有路由器的链路状态
    * 可有度量的概念（费用、距离、时延、带宽etc）
* 只有当链路状态发生变化时，才向所有路由器用洪泛法发送信息
* 更新过程收敛得快

直接采用IP数据报传送——减少路由信息的通信量；不必将长的数据报分片传送。

### 4.2 求发送窗口&拥塞窗口大小

>主机甲、乙建立一个TCP连接，甲的拥塞窗口初始阈值为32KB，甲自己始终发送MSS=1KB大小的段，并且一直有数据发送。乙分配到16KB的数据缓存，并对数据段进行确认。乙收到的数据全部存入缓存，不取走。求甲从连接建立成功起，前5次成功传输时主机甲的发送窗口和拥塞窗口的大小。

计算的是每次成功传输后的窗口值大小

课本的曲线图（P234）是拥塞窗口的变化规律

P221是发送窗口的变化规律，注意区分，二者的策略不一样

有公式 发送窗口=min(接收缓存的通知值，拥塞窗口大小)（课本p236）

它们分别代表了拥塞控制和流量控制

Q：甲的拥塞窗口为何在发送第4报文之后开始线性增长（17KB那里）？（14级的大题也是同样的问题）

![图片](https://uploader.shimo.im/f/fzmIqzvqyGdage68.png!thumbnail?fileGuid=HV8XWQpddyPPdqXP)

|    |1|2|3|4|5|
|:----|:----|:----|:----|:----|:----|
|当前发送了|1|2|4|8|1|
|发送窗口|2|4|8|1|0|
|拥塞窗口|2|4|8|16|17|

之后甲会周期性发送零窗口探测报文（课本p228）

[这里有相关例题，但不一定正确](https://blog.csdn.net/qq_34115899/article/details/82968968)

其中最后一道题第二问，没有发生超时，因此拥塞窗口正常变化，而发送窗口变化规律却不一样

## 2014级

### 1.4 POP3协议

* POP3：邮件读取协议。（接收邮件的用户计算机中的用户代理必须运行POP3客户程序。）用于用户从POP3服务器读取邮件。简单、功能有限。
* IMAP：网际报文存取协议。联机协议。用户可以在不同的地方使用不同的计算机。

### 1.6 IP地址的计算

|IP地址|111.156.33.8|
|:----|:----|
|子网掩码|255.255.240.0|
|网络地址|111.156.32.0|
|直接广播地址|111.156.47.255|
|主机号|0.0.1.8|
|子网内的最大主机数量|4094|
|子网内的最后一个可用IP地址|111.156.47.254|

240=128+64+32+16，即1111 0000

33=32+1，即0010 0001

1111 0000

0010 0001

------------

0010 0000 (32)<--网络地址

0010 1111 . 1111 1111 <--广播地址

4+8=12，2^12-2=4096-2=4094

### 1.7 最短帧长相关计算

>page 88

2*L/2e8<=400*8/1e9

L<=3200/10=320m

（题目至少->至多）

### 1.8 路由表的计算

|N1|5|D|
|:----|:----|:----|
|N2|3|C|
|N3|6|B|
|N4|2|E|
|N5|7|B|
|N6|6|B|

### 1.9 TCP&UDP优缺点

* TCP协议提供了可靠地交付，建立连接后进行数据交换，有确认、窗口、重传、拥塞控制等机制。缺点是效率较低，资源开销大，易被攻击。
* UDP协议传送较快，不需要建立连接，资源开销较小。缺点是不可靠，无拥塞控制，不稳定。

### 1.10 协议和服务

![图片](https://uploader.shimo.im/f/hdZyLK4KEwOsF5u0.png!thumbnail?fileGuid=HV8XWQpddyPPdqXP)

![图片](https://uploader.shimo.im/f/roxoPnsJ7SfNzUlz.png!thumbnail?fileGuid=HV8XWQpddyPPdqXP)

有何区别和联系？

![图片](https://uploader.shimo.im/f/TKdipqoXmgqND3Y2.png!thumbnail?fileGuid=HV8XWQpddyPPdqXP)

### 2.1 滑动窗口协议的理解

（1）[4,5,6,7,8]~[9,10,11,12,13]6种可能

（2）4,5,6,7,8，分别是用来确认4,5,6,7,8序号的分组

更规范的解答，参见计网蓝书p156

### 2.3 拥塞窗口曲线

（1）慢开始：[1,5], [14,18]；拥塞避免：[5,13], [18,22], [23,27]

（2）在第13轮次：超时；第22轮次之后：3ACK

（3）ssthresh被设置为：第1轮(16)，第15轮(12)，第24轮(8)

（4）1+2+4+8+16+17+18+19=85<100，在第9轮次

（5）cwnd=ssthresh=12/2=6

注意区分拥塞窗口和门限值，特别是第（5）问，虽然快重传刚开始cwnd=8，但第27轮次已经涨到12了

建议再看一遍慢启动，快恢复，快重传算法！

### 2.5 滑动窗口协议的应用

// FIXME

（1）第一次：SYN=1, seq=100；第二次：SYN=1，ACK=1，ack=101

（2）A收到的第8个确认段所通告的接收窗口是20-8=12KB，此时A的拥塞窗口变为9，发送窗口变为9

|轮次|发送窗口|拥塞窗口|接收窗口|ssthresh|
|:----|:----|:----|:----|:----|
|1|1|1|20|32|
|2|2|2|19|32|
|3|    |    |    |32|
|4|    |    |    |32|
|5|    |    |    |32|
|6|    |    |    |32|

序号是以字节为单位的，三次握手时，客户A在发起连接请求时用掉一个序号，第三个握手不用序号，因此发数据时，第一个序号是100+1，发了20KB，要20*1024才是用掉的序号。但窗口大小直接算，不用*1024.

## 2015级

1. C
2. C
3. B
4. C
5. 248=128+64+32+16+82^5-2=30 C
6. A
7. ~~Dx~~~~A~~对IP分片数据报的**重组**工作是在**目的地端系统**

**分片：源端系统？**

8. C
9. B
10. 2*3*4=24 B
11. D 16不可达
12. A
13. 192=128+64 160=128+0+32 128+63=191 D
14. A 最前面的是主机名
15. A
### 2.1 网络协议的三个基本要素

* 语法：即数据与控制信息的结果或格式
* 语义：即需要发出何种控制信息，完成何种动作以及做出何种响应
* 同步：即事件实现顺序的详细说明
### 2.3 OSI/RM七层模型中各层的主要作用

![图片](https://uploader.shimo.im/f/bxigsTqR5TIbH2cl.png!thumbnail?fileGuid=HV8XWQpddyPPdqXP)

![图片](https://uploader.shimo.im/f/1joN0tKMCOssxuLX.png!thumbnail?fileGuid=HV8XWQpddyPPdqXP)

### 2.5 奇偶校验的优缺点

* 优点：简单
* 缺点：漏检率高
### 2.6 数据链路层解决可靠传输

* CRC循环冗余校验
* 增加帧编号、确认和重传机制来解决帧丢失、帧重复、帧失序的问题
### 2.7 解决用户增多，网络性能急剧下降的问题

* 10M变100M
* 增加总线带宽
* 提供吞吐量

// TODO:每种方案的优缺点

// FIXME

我觉得扩展网络带宽的缺点花费较高，优点是方案的可扩展性较好，能够支持较多的用户加入

然后使用划分子网和使用拥塞控制算法的优点都是成本较低

划分子网的缺点是可扩展性较差，无法支持更多用户的加入

拥塞控制的缺点是无法保证高的数据传输率

### 2.10 传输数据的计算

// TODO:MTU的概念

2000=960+960+80，要拆成3段

2000+160*3=2480bit

### 2.11 CIDR的计算

>已知地址块中的一个地址是202.120.84.24/18。试求这个地址块中的最小地址和最大地址。地址掩码是什么？地址块中共有多少个地址？相当于多少个C类地址？

202.120.84.24/18 18=8+8+2

84=64+16+4, 0101 0100

最小地址：0100 0000. 0000 0001 即202.120.64.1

最大地址：0111 1111(255-128=127).1111 1110 即202.120.127.254

地址掩码：255.255.192.0

共有地址多少个：2^14-2

相当于多少个C类地址：(C类地址共2^8-2) 2^6

// FIXME 减2？应该是不用减的吧

### 2.12 端口号的作用和意义

软件端口号是应用层的各种协议进程与运输实体进行层间交互的一种地址。端口号标志本计算机应用层中的各个进程在和运输层交互时的层间接口。两个进程要互相通信，需要知道对方的IP地址和端口号（为了找到对方计算机中的应用进程）

* 服务器端使用的端口号
    * 熟知端口号
* 客户端使用的端口号
    * 仅在客户进程运行时才动态选择

### 2.13 计算最大吞吐量和利用率

>通信信道速率为1Gb/s，端到端时延为5ms。TCP的发送窗口为65536字节。试问：可能达到的最大吞吐量是多少？信道的利用率是多少？

由发送时延=数据长度/信道带宽=65536*8bit/1Gb/s=5.24288e-4s=0.524288ms

来回的传播时延=5ms*2=10ms

总时延=10.524288ms

所以每秒可以产生1000/10.52428个窗口

最大吞吐量=65535*8*1000/10.524288=49816196.59bit/s

信道利用率=最大吞吐量/信道带宽=(49816196.59bit/s)/(1Gbit/s)*100%=4.98%

// TODO:下面这个答案似乎更好掌握一些, 注意单位

![图片](https://uploader.shimo.im/f/NLqeldhrXGaKzvaY.png!thumbnail?fileGuid=HV8XWQpddyPPdqXP)

### 2.14 拥塞窗口的计算

>一个TCP 连接总是以1KB 的最大段发送TCP 段,发送方有足够多的数据要发送。当拥塞窗口为16KB 时发生了超时重传,此时的慢启动门限和拥塞窗口分别是多少？若接下来的7 个RTT(往返时间)时间内的TCP 段的传输都是成功的,那么当第7 个RTT 时间内发送的所有TCP 段都得到肯定应答时, 此时的慢启动门限和拥塞窗口分别是多少？

（1）慢启动门限：8kb；拥塞窗口：1kb

（2）1:1, 2:2, 3:4, 4:8, 5:9, 6:10, 7:11，此时慢启动门限：8kb，拥塞窗口：12kb

### 2.15 域名服务器中高速缓存的作用

>page 259

为了提高DNS查询效率，并减轻根域名服务器的负荷和减少互联网上的DNS查询报文数量，在域名服务器中广泛地使用了高速缓存。高速缓存用来存放最近查询过的域名以及从何处获得域名映射信息的记录。

## More

|协议|连接|可靠|
|:----|:----|:----|
|PPP|N|N|
|MAC|N|N（取决于信道质量？）|
|IP|N|N|
|TCP|Y|Y|
|UDP|N|N|

* HTTP是可靠的，本身是无连接的（虽然使用了TCP协议）,也是无状态的（page268）
